var e=new Promise((function(e){if("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll)setTimeout((function(){return e()}),1);else{var t=function(){e(),document.removeEventListener("DOMContentLoaded",t,!1)};document.addEventListener("DOMContentLoaded",t,!1)}}));function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=a(e);if(t){var r=a(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return l(this,n)}}function u(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var h=function(){function e(){n(this,e)}return r(e,[{key:"asCss",value:function(){throw new Error("not implemented")}}]),e}(),d=function(e){function t(){return n(this,t),i.apply(this,arguments)}o(t,h);var i=c(t);return r(t,[{key:"section",value:function(){throw new Error("not implemented")}},{key:"endCss",value:function(){throw new Error("not implemented")}}]),t}(),y=function(e){function t(){return n(this,t),i.apply(this,arguments)}o(t,h);var i=c(t);return r(t,[{key:"match",value:function(){throw new Error("not implemented")}},{key:"property",value:function(){throw new Error("not implemented")}},{key:"endSection",value:function(){throw new Error("not implemented")}}]),t}(),f=function(e){function t(){return n(this,t),i.apply(this,arguments)}o(t,h);var i=c(t);return t}(),m=function(e){function t(e){var r;n(this,t),r=i.call(this);var o=e=e||{},a=o.name,s=o.value,l=o.important,c=o.parent;return r._name=a,r._value=s,r._important=l||!1,r._parent=c,r}o(t,f);var i=c(t);return r(t,[{key:"asCss",value:function(e){var t=e=e||{},n=t.important;t.format;return n=n||this._important,"".concat(this._name,":").concat(this._value).concat(n?" !important":"",";")}},{key:"important",set:function(e){this._important=e}}]),t}(),v=function(e){function t(e){var r,o=e.matches,a=e.important,s=e.parent;return n(this,t),(r=i.call(this))._matches=o||[],r._properties=[],r._important=a||!1,r._parent=s,r}o(t,y);var i=c(t);return r(t,[{key:"match",value:function(e){return this._matches.push(e),this}},{key:"property",value:function(e,t,n){var i=new m({name:e,value:t,important:n,parent:this});return this._properties.push(i),this}},{key:"endSection",value:function(){return this._parent}},{key:"asCss",value:function(e){var t=e=e||{},n=t.important,i=t.format;return n=n||this._important,"".concat(this._matches.join(","),"{").concat(this._properties.map((function(e){return e.asCss({important:n,format:i})})).join(""),"}")}}]),t}(),_=function(e){function t(e){var r;n(this,t),r=i.call(this);var o=e=e||{},a=o.onEnd,s=o.important;return r._sections=[],r._important=s||!1,r._onEnd=a,r}o(t,d);var i=c(t);return r(t,[{key:"section",value:function(e){var t=(e=e||{}).important,n=new v({important:t,parent:this});return this._sections.push(n),n}},{key:"endCss",value:function(){(0,this._onEnd)(this)}},{key:"asCss",value:function(e){var t=e=e||{},n=t.important,i=t.format;return n=n||this._important,this._sections.map((function(e){return e.asCss({important:n,format:i})})).join("")}}]),t}(),g=function(){function e(){n(this,e)}return r(e,[{key:"setCssProperty",value:function(e,t,n){e&&(e.style[t]=n)}},{key:"setCssProperties",value:function(e,t){var n=this;e&&Object.keys(t).forEach((function(i){n.setCssProperty(e,i,t[i])}))}},{key:"installCss",value:function(e){var t=document.createElement("style");t.type="text/css",t.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(t)}},{key:"startFluentCss",value:function(e){var t=this,n=e.important,i=e.format;return new _({onEnd:function(e){var r=e.asCss({important:n,format:i});t.installCss(r)}})}},{key:"setHtmlContent",value:function(e,t){e.innerHTML=t}},{key:"setTextContent",value:function(e,t){e.innerText=t}},{key:"createElement",value:function(e,n){var i=this,r=document.createElement(e);return n&&Object.keys(n).forEach((function(e){switch(e){case"attr":var o=n.attr;Object.keys(o).forEach((function(e){r[e]=o[e]}));break;case"style":i.setCssProperties(r,n.style);break;case"id":r.id=n.id;break;case"className":r.classList.add(n.className);break;case"classNames":var a;(a=r.classList).add.apply(a,u(n.classNames));break;case"parent":var s=n.parent;s&&s.appendChild(r);break;case"html":i.setHtmlContent(r,n.html);break;case"text":i.setTextContent(r,n.text);break;case"onClick":r.addEventListener("click",n.onClick);break;case"onChange":r.addEventListener("change",(function(e){return n.onChange(e.target.value)}));break;case"onInput":r.addEventListener("input",(function(e){return n.onInput(e.target.value)}));break;case"onLoad":r.addEventListener("load",(function(){return n.onLoad()}));break;case"content":var l=function(e){e.forEach((function(e){e instanceof HTMLElement?r.appendChild(e):t(e)===t("")?r.appendChild(document.createTextNode(e)):t(e)===t([])&&l(e)}))};l(n.content);break;case"onInstance":(0,n.onInstance)(r)}})),r}},{key:"remove",value:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"getElementsByClassName",value:function(e){return u(document.getElementsByClassName(e))}},{key:"getElementsByTagName",value:function(e){return u(document.getElementsByTagName(e))}},{key:"addClass",value:function(e,t){e&&e.classList.add(t)}},{key:"removeClass",value:function(e,t){e&&e.classList.remove(t)}},{key:"setClass",value:function(e,t,n){e&&(n?e.classList.add(t):e.classList.remove(t))}},{key:"removeClassStartingWith",value:function(e,t){e&&u(e.classList).filter((function(e){return e.startsWith(t)})).forEach((function(t){e.classList.remove(t)}))}}]),e}(),k=function(){function e(t){var i=this,r=t.domAccess,o=t.parent;n(this,e),this._domAccess=r,this._parent=o,this._image=null,this._div=r.createElement("div",{parent:o,className:"qilvgallery_image_outter",content:[r.createElement("a",{parent:this._div,onInstance:function(e){return i._a=e}})]})}return r(e,[{key:"setIsLoaded",value:function(){this._domAccess.removeClass(this._image,"qilv_loading")}},{key:"setLoading",value:function(){this._domAccess.addClass(this._image,"qilv_loading")}},{key:"replaceImage",value:function(e){var t=this;null!=this._image&&this._image.remove(),this._image=this._domAccess.createElement("img",{classNames:["qilvgallery_image"],parent:this._a,onLoad:function(){return t.setIsLoaded()},attr:{src:"#"}}),this.setLoading(),this._image.src=e,this._a.href=e,this._a.target="_blank"}},{key:"hide",value:function(){this._domAccess.removeClass(this._div,"qilv_shown")}},{key:"show",value:function(){this._domAccess.addClass(this._div,"qilv_shown")}},{key:"accessKey",set:function(e){this._a.accesskey=e}},{key:"imageSource",get:function(){return this._image?this._image.src:null}}]),e}(),b=function(){function e(t){var i=t.imageOverlayUi;return n(this,e),this._imageOverlayUi=i,null}return r(e,[{key:"update",value:function(e,t){this.id=e,this._imageOverlayUi.replaceImage(t)}},{key:"hide",value:function(){this._imageOverlayUi.hide(),this._imageOverlayUi.accessKey=void 0}},{key:"show",value:function(){this._imageOverlayUi.accessKey="l",this._imageOverlayUi.show()}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"imageSource",get:function(){return this._imageOverlayUi.imageSource}}]),e}(),w=function(){function e(){n(this,e)}return r(e,[{key:"getBindableMethods",value:function(){return null}},{key:"getKeyBindings",value:function(){return null}}]),e}(),x=function(){function e(t){var i=this,r=t.config;n(this,e),this._config=r;var o={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBSTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,COMMA:188,PERIOD:190};this._keyValuesByName=o,this.globalBindings={},this.handle_key_elements=[],this._reverseKeysByNumber={},this.keys=[],this.values=[],Object.keys(o).forEach((function(e){var t=i._keyValuesByName[e];i._reverseKeysByNumber[t]=e,i.keys.push(e),i.values.push(t)}))}return r(e,[{key:"getName",value:function(e){return null==this._reverseKeysByNumber[e]?"".concat(e):this._reverseKeysByNumber[e]}},{key:"getValue",value:function(e){return e=e.toUpperCase(),this._keyValuesByName[e]}},{key:"handle_key",value:function(e){if(!(e.ctrlKey||e.shiftKey||e.altKey)&&null!=this.globalBindings[e.which]){var t=this.globalBindings[e.which],n=t.target,i=t.methodName;n[i]({event:e,method_name:i}),e.preventDefault(),e.stopPropagation()}}},{key:"auto_bind",value:function(e,t){var n=this;null==t&&(t=document);var i=e.getBindableMethods(),r=e.getKeyBindings();null==i&&(i={});var o=[];Object.keys(this.globalBindings).forEach((function(t){n.globalBindings[t].target===e&&o.push(t)})),o.forEach((function(e){delete n.globalBindings[e]})),Object.keys(r).forEach((function(t){var o=r[t];n.globalBindings[n.getValue(t)]={target:e,methodName:o},-1==Object.keys(i).indexOf(o)&&(i[o]="??? ("+o+")")})),this.keys.forEach((function(t){var i=n._config["VK."+t];if(null!=i){var r=e.__name__;r=r?r+".":"",i.substring(0,r.length)===r&&(""===(i=i.substring(r.length))?delete n.globalBindings[n.getValue(t)]:n.globalBindings[n.getValue(t)]={target:e,methodName:i})}})),0>this.handle_key_elements.indexOf(t)&&(this.handle_key_elements.push(t),t.addEventListener("keydown",(function(e){return n.handle_key(e)})))}}]),e}(),S=function(){function e(t){var i=t.domAccess;n(this,e),this._domAccess=i,this._preloadGauge=null,this._preloadGaugeInner=null}return r(e,[{key:"createBlackScreen",value:function(e){var t=e.parent;return this._domAccess.createElement("div",{parent:t,id:"qilvgallery_black_screen"})}},{key:"removeBlackScreen",value:function(e){this._domAccess.remove(e)}},{key:"createInfoTip",value:function(e){var t=this._domAccess;void 0===e&&(e={});var n={className:"qilvgallery_infotip"};void 0!==n.id&&(n.id=e.id),e.parent&&(n.parent=e.parent),e.content&&(n.content=e.content),e.classNames&&(n.classNames=e.classNames);var i=t.createElement("div",n);return e.position&&t.setCssProperty(i,"position",e.position),void 0!==e.center&&e.center&&i.classList.add("qilvgallery_infotip_center"),void 0!==e.fadeOut&&setTimeout((function(){return t.remove(i)}),e.fadeOut),i}},{key:"createTempMessage",value:function(e,t){this.createInfoTip({fadeOut:1500,parent:t,position:"fixed",content:[e]})}},{key:"removeInfoBox",value:function(e){e&&this._domAccess.remove(e)}},{key:"createInfoBox",value:function(e){var t=e.parent,n=e.hrefs,i=e.isCurrent,r=this._domAccess,o=this.createInfoTip({parent:t}),a=r.createElement("pre",{parent:o,content:[n.map((function(e){var t="span";return i(e)&&(t="b"),[r.createElement(t,{text:e}),r.createElement("br")]}))],onClick:function(){var e="",t=0,i=0;n.forEach((function(n){e+=n,e+="\n",i+=1,n.length>t&&(t=n.length)})),r.remove(a),r.createElement("textarea",{parent:o,attr:{rows:"".concat(i+1),cols:"".concat(t+2),className:"qilvgallery_infobox_textarea",readonly:1,value:e}}).select()}});return o}},{key:"showPreloadGauge",value:function(e){var t=e.parent,n=e.onComplete,i=e.preloadGaugeInfo;if(!i){var r=this._domAccess.createElement("div",{parent:t,className:"qilvgallery_preload_gauge"});i={preloadGauge:r,preloadGaugeInner:this._domAccess.createElement("div",{parent:r,className:"qilvgallery_preload_gauge_inner"}),onComplete:n}}return i}},{key:"hidePreloadGauge",value:function(e){var t=e.preloadGaugeInfo;t&&(this._domAccess.remove(t.preloadGaugeInner),this._domAccess.remove(t.preloadGauge))}},{key:"updatePreloadGauge",value:function(e){var t=e.loaded,n=e.total,i=e.preloadGaugeInfo;if(i){var r=this._domAccess,o="".concat(Math.floor(100*t/n),"%");r.setCssProperty(i.preloadGaugeInner,"width",o),r.setTextContent(i.preloadGaugeInner,o),r.setTextContent(i.preloadGaugeInner,"".concat(t," / ").concat(n)),t===n&&i.onComplete()}}},{key:"ensurePreloadAll",value:function(e){var t=this,n=e.hrefs,i=e.onImageLoaded,r=e.parent;if(!this._preloadAllPanel){var o=this._domAccess;this._preloadAllPanel=o.createElement("div",{parent:r,id:"qilvgallery_preload_all_panel"}),n.forEach((function(e){o.createElement("img",{parent:t._preloadAllPanel,onLoad:i,attr:{src:"#"}}).src=e}))}}},{key:"removeAboutInfoBox",value:function(e){this._domAccess.remove(e)}},{key:"createAboutInfoBox",value:function(e){var t=e.parent,n=e.onClick,i=e.version,r=this._domAccess,o="https://github.com/webgiss/qilvgallery";return r.createElement("div",{parent:t,className:"qilvgallery_about_infobox",content:[r.createElement("div",{className:"qilvgallery_infotip_about_blackscreen",onClick:n}),this.createInfoTip({id:"QILVGallery_About",center:!0,classNames:["qilvgallery_infotip_about"],content:[r.createElement("p",{text:"QILV Gallery",className:"qilvgallery_infotip_about_title"}),r.createElement("p",{text:"Version : ".concat(i),className:"qilvgallery_infotip_about_version"}),r.createElement("a",{text:o,attr:{href:o,target:"_blank"}}),r.createElement("br"),r.createElement("div",{text:"Close",className:"qilvgallery_infotip_about_button",onClick:n})]})]})}},{key:"removeHelpInfoTip",value:function(e){this._domAccess.remove(e)}},{key:"createHelpInfoTip",value:function(e){var t=e.parent,n=e.bindings,i=e.configurations,r=e.version,o=this._domAccess;return this.createInfoTip({parent:t,classNames:["qilvgallery_infotip_help"],content:[o.createElement("p",{text:"Version: ".concat(r)}),o.createElement("h1",{text:"Keyboard configuration",className:"qilvgallery_infotip_help_title"}),o.createElement("div",{className:"qilvgallery_infotip_help_content",content:n.map((function(e){var t=e.keyName,n=e.methodName;return o.createElement("div",{content:[o.createElement("b",{text:t}),o.createElement("span",{text:": ".concat(n)})]})}))}),o.createElement("h1",{text:"Values",className:"qilvgallery_infotip_help_title"}),o.createElement("div",{className:"qilvgallery_infotip_help_content",content:i.map((function(e){var t=e.comment,n=e.configured,i=e.effective,r=e.defaultValue;return o.createElement("div",{content:[o.createElement("b",{text:t}),o.createElement("span",{text:": ".concat(i," (configured = ").concat(n," ; default = ").concat(r,")")})]})}))})]})}},{key:"createMainElement",value:function(){return this._domAccess.createElement("div",{parent:document.body,id:"qilvgallery_main_element"})}},{key:"createViewer",value:function(e){var t=e.parent;return this._domAccess.createElement("div",{parent:t,id:"qilvgallery_viewer"})}},{key:"getLinkRefs",value:function(){return this._domAccess.getElementsByTagName("a").map((function(e){return{href:e.href,element:e}}))}},{key:"setImageRef",value:function(e){var t=e.element,n=e.id;this._domAccess.addClass(t,"qilvgallery_source_image"),this._domAccess.addClass(t,"qilvgallery_source_image_".concat(n))}},{key:"setRelative",value:function(e){var t=e.element,n=e.relative;this._domAccess.setClass(t,"qilv_relative",n)}},{key:"setAutoX",value:function(e){var t=e.element,n=e.autoX;this._domAccess.setClass(t,"qilv_autoX",n)}},{key:"setAutoY",value:function(e){var t=e.element,n=e.autoY;this._domAccess.setClass(t,"qilv_autoY",n)}},{key:"setAutoY",value:function(e){var t=e.element,n=e.autoY;this._domAccess.setClass(t,"qilv_autoY",n)}},{key:"setCentered",value:function(e){var t=e.element,n=e.centered;this._domAccess.setClass(t,"qilv_centered",n)}},{key:"setMaxSize",value:function(e){var t=e.element,n=e.maxSize;this._domAccess.setClass(t,"qilv_maxSize",n)}},{key:"setShown",value:function(e){var t=e.element,n=e.shown;this._domAccess.setClass(t,"qilv_shown",n)}},{key:"setTransition",value:function(e){var t=e.element,n=e.transitionTime;this._domAccess.removeClassStartingWith(t,"qilv_transition-"),this._domAccess.addClass(t,"qilv_transition-".concat(n))}},{key:"installCss",value:function(){this._domAccess.startFluentCss({important:!0}).section().match("#qilvgallery_viewer").property("position","absolute").property("z-index","50000").property("display","none").property("top","0").property("bottom","0").property("margin","0").property("left","0").property("right","0").endSection().section().match("#qilvgallery_viewer.qilv_shown").property("z-index","50001").property("display","block").endSection().section().match("#qilvgallery_viewer.qilv_relative").property("position","fixed").endSection().section().match(".qilvgallery_infotip").property("display","block").property("position","absolute").property("left","4px").property("top","4px").property("padding","15px").property("font-size","13px").property("background","linear-gradient(180deg, #f8f8f8, #dddddd)").property("color","#000000").property("font-family",'"consolas","courier new",monospace').property("border","2px solid").property("border-color","#ffffff #f8f8f8 #b8b8b8 #f8f8f8").property("border-radius","5px").property("z-index","50001").endSection().section().match(".qilvgallery_infotip > pre").property("margin","0").endSection().section().match(".qilvgallery_preload_gauge").property("z-index","50101").property("border","1px solid black").property("width","100%").property("position","fixed").property("bottom","0").property("height","13px").property("background-color","#eee").endSection().section().match(".qilvgallery_preload_gauge_inner").property("z-index","50102").property("border","0").property("padding","0").property("margin","0").property("width","0%").property("position","static").property("left","0").property("top","0").property("height","100%").property("background-color","#f03").property("text-align","center").property("font-size","11px").property("font-family","Arial,Verdana,sans-serif,Helvetica").property("font-weight","bold").property("color","#000000").endSection().section().match(".qilvgallery_infotip_about_blackscreen").property("z-index","50098").property("width","100%").property("height","100%").property("position","fixed").property("left","0px").property("top","0px").property("background","black").property("opacity","0.8").endSection().section().match(".qilvgallery_infotip_about_title").property("font-size","20pt").endSection().section().match(".qilvgallery_infotip_about_button").property("width","20em").property("border","1px solid #666").property("background","#ccc").property("border-radius","8px").property("background","linear-gradient(0, #aaa, #eee)").property("left","0px").property("right","0px").property("margin","100px auto auto").endSection().section().match(".qilvgallery_infotip_center").property("position","fixed").property("left","0").property("right","0").property("top","0").property("bottom","0").property("margin","auto").endSection().section().match(".qilvgallery_infotip_about").property("font-family",'"Trebuchet MS","Tahoma","Verdana","Arial","sans-serif"').property("font-size","15pt").property("text-align","center").property("max-width","500px").property("max-height","300px").property("border","1px solid white").property("background","linear-gradient(180deg, #f8f8f8, #dddddd)").property("z-index","50100").endSection().section().match(".qilvgallery_infotip_help").property("display","block").property("position","absolute").property("left","4px").property("top","4px").property("padding","15px").property("font-size","13px").property("border","1px solid white").property("background","linear-gradient(180deg, #f8f8f8, #dddddd)").property("color","#000000").property("font-family",'"courier new"').property("border-radius","5px").property("z-index","50001").endSection().section().match(".qilvgallery_infotip_help_title").property("font-size","2em").property("font-weight","bold").endSection().section().match(".qilvgallery_infotip_help_content").property("margin-left","10px").endSection().section().match(".qilvgallery_infobox_textarea").property("white-space","pre").endSection().section().match(".qilvgallery_about_infobox").property("margin","0").property("padding","0").property("border","0").endSection().section().match(".qilvgallery_image_outter").property("margin","0").property("padding","0").property("border","0").property("position","absolute").property("display","block").property("opacity","0").property("left","0").property("right","0").property("top","0").property("bottom","0").property("transition","opacity ease-out").property("transition-duration","0s").endSection().section().match(".qilv_transition-300 .qilvgallery_image_outter").property("transition-duration","0.3s").endSection().section().match(".qilv_transition-800 .qilvgallery_image_outter").property("transition-duration","0.8s").endSection().section().match(".qilv_transition-1500 .qilvgallery_image_outter").property("transition-duration","1.5s").endSection().section().match(".qilvgallery_image_outter.qilv_shown").property("opacity","1").property("display","block").endSection().section().match(".qilvgallery_image").property("margin","unset").property("padding","0").property("display","block").property("position","absolute").property("left","0").property("top","0").property("z-index","50000").property("box-sizing","border-box").property("border","2px solid black").property("right","unset").property("bottom","unset").property("width","auto").property("height","auto").property("max-width","unset").property("max-height","unset").endSection().section().match(".qilv_maxSize .qilvgallery_image").property("max-width","100%").property("max-height","100%").endSection().section().match(".qilv_autoX .qilvgallery_image").property("width","100%").endSection().section().match(".qilv_autoY .qilvgallery_image").property("height","100%").endSection().section().match(".qilvgallery_image.qilv_loading").property("border","2px solid red").endSection().section().match(".qilv_centered .qilvgallery_image").property("right","0").property("bottom","0").property("margin","auto").endSection().section().match("#qilvgallery_preload_all_panel").property("display","none").endSection().section().match("#qilvgallery_black_screen").property("z-index","499998").property("width","100%").property("height","100%").property("left","0").property("top","0").property("background","black").property("margin","0").property("padding","0").endSection().endCss()}}]),e}(),A=function(){function e(t){var i=t.domAccess;n(this,e),this._domAccess=i}return r(e,[{key:"createImageOverylay",value:function(e){var t=this._domAccess,n=new k({domAccess:t,parent:e});return new b({imageOverlayUi:n})}}]),e}(),E=function(e){function t(e){var r,o=e.imageOverlayFactory,a=e.galleryOverlaysUi,s=e.vk,l=e.config;return n(this,t),(r=i.call(this))._imageOverlayFactory=o,r._galleryOverlaysUi=a,r._vk=s,r._config=l,r._preloadGaugeInfo=null,r._configurables={slideshowSpeed:{label:"Initial slideshow speed (ms)",default:"500"},transitionTime:{label:"Initial transition's effect's time (ms)",default:"0"},slideshowMode:{label:"Slideshow on at start ?",default:"false"},preloadAllMode:{label:"Preload all at start ?",default:"true"},maxSize:{label:"Fit the image to the screen if bigger than the screen at start ?",default:"true"},relative:{label:"Show image at the top of the screen instead of the top of the page at start ?",default:"true"},blackScreenMode:{label:"Show on 'black screen' mode at start ?",default:"true"}},r._bindables={goPrev:"Go to previous image",goNext:"Go to next image",toggleInfoBox:"Show/hide the infobox of image list",toggle:"Show/Hide the current image",openLink:"Open the image in a new window/tab",toggleSlideshow:"Start/stop the slideshow",togglePosition:"Show current image at top of the page/top of the screen",speedUpSlideshow:"Increase the slideshow speed",speedDownSlideshow:"Decrease the slideshow speed",toggleMaxSize:"Fit the image if larger than the screen/Show whole image",toggleAutoX:"Width of the image fit/doesn't fit to width of the screen",toggleAutoY:"Height of the image fit/doesn't fit to height of the screen",toggleAutoXY:"Width and height of the image fit/doesn't fit to width and height of the screen",toggleBlackScreen:"Set or remove the black screen",cycleTransitionTime:"Change transition's effect's time",preloadAll:"Pre-load all images (may take some resources)",about:"Show/Hide about box",help:"Show/Hide help box"},r._key_bindings={BACKSPACE:"goPrev",J:"goPrev",SPACE:"goNext",K:"goNext",I:"toggleInfoBox",H:"toggle",L:"openLink",S:"toggleSlideshow",R:"togglePosition",NUMPAD_ADD:"speedUpSlideshow",NUMPAD_SUBSTRACT:"speedDownSlideshow",M:"toggleMaxSize",X:"toggleAutoX",Y:"toggleAutoY",Z:"toggleAutoXY",B:"toggleBlackScreen",T:"cycleTransitionTime",P:"preloadAll",NUMPAD_MULTIPLY:"help",NUMPAD_DIVIDE:"about"},r.__name__="Gallery",r._prev=null,r._next=null,r._current=null,r._slideshowMode=null,r._preloadAllMode=null,r._slideshowSpeed=null,r._transitionTime=null,r._maxSize=null,r._relative=!0,r._blackScreenMode=null,r._slideshowDirNext=!0,r._autoX=!1,r._autoY=!1,r._centered=!1,r._blackScreen=null,r._shown=!0,r}o(t,w);var i=c(t);return r(t,[{key:"getBindableMethods",value:function(){return this._bindables}},{key:"getKeyBindings",value:function(){return this._key_bindings}},{key:"getConfigurables",value:function(){return this._configurables}},{key:"setTransitionTime",value:function(e,t){this._transitionTime=e,this._galleryOverlaysUi.setTransition({element:this._viewer,transitionTime:e}),t||this.createTempMessage("Transition's effect's time : ".concat(e," ms"))}},{key:"createTempMessage",value:function(e){this._galleryOverlaysUi.createTempMessage(e,this._mainElement)}},{key:"cycleTransitionTime",value:function(){var e=this._transitionTime;e=0===e?300:300>=e?800:800>=e?1500:0,this.setTransitionTime(e)}},{key:"setBlackScreenMode",value:function(e){e&&!this._blackScreen&&(this._blackScreen=this._galleryOverlaysUi.createBlackScreen({parent:this._viewer})),!e&&this._blackScreen&&(this._galleryOverlaysUi.removeBlackScreen(this._blackScreen),this._blackScreen=null),this.centered=e}},{key:"showSlideshowSlide",value:function(){this.slideshowMode&&(this._slideshowDirNext?this.goNext():this.goPrev(),this.prepareNextSlide())}},{key:"prepareNextSlide",value:function(){var e=this;setTimeout((function(){return e.showSlideshowSlide()}),this._slideshowSpeed)}},{key:"toggleSlideshow",value:function(){this.slideshowMode=!this.slideshowMode}},{key:"setSlideshowSpeed",value:function(e,t){this._slideshowSpeed=e,t||this.createTempMessage("Speed : ".concat(this._slideshowSpeed," ms"))}},{key:"speedUpSlideshow",value:function(){100<this.slideshowSpeed&&(this.slideshowSpeed-=100)}},{key:"speedDownSlideshow",value:function(){this.slideshowSpeed+=100}},{key:"goPrev",value:function(){this._slideshowDirNext=!1,this._current.hide();var e=[this._current,this._prev,this._next];this._next=e[0],this._current=e[1],this._prev=e[2],this._current.show();var t=this._current.id,n=this._links[t].prevId;this._prev.update(n,this._links[n].href),this.removeBoxes(),this.shown=!0}},{key:"goNext",value:function(){this._slideshowDirNext=!0,this._current.hide();var e=[this._next,this._current,this._prev];this._current=e[0],this._prev=e[1],this._next=e[2],this._current.show();var t=this._current.id,n=this._links[t].nextId;this._next.update(n,this._links[n].href),this.removeBoxes(),this.shown=!0}},{key:"goNum",value:function(e){var t=this._links[e].prevId,n=this._links[e].nextId;this._current.update(e,this._links[e].href),this._prev.update(t,this._links[t].href),this._next.update(n,this._links[n].href),this.removeBoxes(),this.shown=!0}},{key:"removeBoxes",value:function(){this.removeInfoBox(),this.removeAbout(),this.removeHelp()}},{key:"setMaxSize",value:function(e){this._maxSize=e,this._galleryOverlaysUi.setMaxSize({element:this._viewer,maxSize:this._maxSize})}},{key:"toggleMaxSize",value:function(){this.maxSize=!this.maxSize}},{key:"toggleAutoX",value:function(){this.autoX=!this.autoX}},{key:"toggleAutoY",value:function(){this.autoY=!this.autoY}},{key:"toggleAutoXY",value:function(){this.autoX||this.autoY?(this.autoX=!1,this.autoY=!1):(this.autoX=!0,this.autoY=!0)}},{key:"isCurrent",value:function(e){return this._current.imageSource===e}},{key:"removeInfoBox",value:function(){this._infoBox&&(this._galleryOverlaysUi.removeInfoBox(this._infoBox),this._infoBox=null)}},{key:"toggleInfoBox",value:function(){var e=this;this._infoBox?this.removeInfoBox():this._infoBox=this._galleryOverlaysUi.createInfoBox({hrefs:Object.values(this._links).map((function(e){return e.href})),isCurrent:function(t){return e.isCurrent(t)},parent:this._mainElement})}},{key:"toggle",value:function(){this.shown=!this.shown}},{key:"togglePosition",value:function(){this.relative=!this.relative}},{key:"toggleBlackScreen",value:function(){this.blackScreenMode=!this.blackScreenMode}},{key:"openLink",value:function(){window.open(this._current.imageSource)}},{key:"showPreloadGauge",value:function(){var e=this;this._preloadGaugeInfo=this._galleryOverlaysUi.showPreloadGauge({parent:this._mainElement,onComplete:function(){return e.hidePreloadGauge()},preloadGaugeInfo:this._preloadGaugeInfo}),this.updatePreloadGauge()}},{key:"hidePreloadGauge",value:function(){this._galleryOverlaysUi.hidePreloadGauge({preloadGaugeInfo:this._preloadGaugeInfo}),this._preloadGaugeInfo=null}},{key:"updatePreloadGauge",value:function(){this._galleryOverlaysUi.updatePreloadGauge({loaded:this._loaded,total:this._totalToLoad,preloadGaugeInfo:this._preloadGaugeInfo})}},{key:"preloadAll",value:function(e){var t=this,n=e.parent,i=Object.values(this._links).map((function(e){return e.href}));this._loaded=0,this._totalToLoad=i.length,this._galleryOverlaysUi.ensurePreloadAll({hrefs:i,onImageLoaded:function(){t._loaded+=1,t.updatePreloadGauge()},parent:n}),this._preloadGaugeInfo||this.showPreloadGauge()}},{key:"about",value:function(){var e=this;this._aboutInfoBox?this.removeAbout():this._aboutInfoBox=this._galleryOverlaysUi.createAboutInfoBox({parent:this._mainElement,onClick:function(){e.removeAbout()},version:"3.0.11 - 84c74ad"})}},{key:"removeAbout",value:function(){null!=this._aboutInfoBox&&(this._galleryOverlaysUi.removeAboutInfoBox(this._aboutInfoBox),this._aboutInfoBox=null)}},{key:"help",value:function(){var e=this;if(this._helpInfoTip)this.removeHelp();else{var t=[],n=[];Object.keys(this._vk.globalBindings).forEach((function(n){var i=e._vk.globalBindings[n],r=e.getBindableMethods();if(i&&i.target===e){var o=i.methodName;t.push({keyName:e._vk.getName(n),methodName:o in r?r[o]:o})}})),Object.keys(this._configurables).forEach((function(t){var i=e._configurables[t].label,r=e._config["QILV."+t]||void 0,o=e._configurables[t].default,a=e[t];n.push({comment:i,configured:r,effective:a,defaultValue:o})})),this._helpInfoTip=this._galleryOverlaysUi.createHelpInfoTip({parent:this._mainElement,bindings:t,configurations:n,version:"3.0.11 - 84c74ad"})}}},{key:"removeHelp",value:function(){this._helpInfoTip&&(this._galleryOverlaysUi.removeHelpInfoTip(this._helpInfoTip),this._helpInfoTip=null)}},{key:"init",value:function(){var e=this;this._mainElement=this._galleryOverlaysUi.createMainElement(),this._viewer=this._galleryOverlaysUi.createViewer({parent:this._mainElement}),this._galleryOverlaysUi.installCss(),this._prev=this._imageOverlayFactory.createImageOverylay(this._viewer),this._current=this._imageOverlayFactory.createImageOverylay(this._viewer),this._next=this._imageOverlayFactory.createImageOverylay(this._viewer);var t=null,n=this._galleryOverlaysUi.getLinkRefs().filter((function(e){var n=e.href,i=!1;return n&&[".png",".gif",".jpg",".jpeg"].map((function(e){-1===n.indexOf("?")&&n.substr(n.length-e.length,e.length).toLowerCase()===e&&n!==t&&(i=!0)})),i&&(t=n),i}));return this._links={},n.forEach((function(t,i){var r=t.element,o=t.href,a="".concat(i);e._galleryOverlaysUi.setImageRef({element:r,id:a});var s=0===i?n.length-1:i-1,l=i===n.length-1?0:i+1;e._links[a]={id:a,prevId:s,nextId:l,href:o}})),0==n.length?(this._galleryOverlaysUi.createTempMessage("No links to image found in this page !",document.body),this.slideshowMode=!1,void(this.blackScreenMode=!1)):(this.goNum(0),this._vk.auto_bind(this),Object.keys(this._configurables).forEach((function(t){var n=e._config["QILV."+t]||e._configurables[t].default;null!=n&&(n.match(/^\-?[0-9]+$/)&&(n=parseInt(n)),"false"===n&&(n=!1),"true"===n&&(n=!0),e["_"+t]=n)})),this._current.show(),this.preloadAllMode=this._preloadAllMode,this.relative=this._relative,this.autoX=this._autoX,this.autoY=this._autoY,this.setMaxSize(this._maxSize,!0),this.centered=this._centered,this.blackScreenMode=this._blackScreenMode,this.transitionTime=this._transitionTime,this.slideshowMode=this._slideshowMode,this.setSlideshowSpeed(this._slideshowSpeed,!0),void(this.shown=this._shown))}},{key:"autoX",get:function(){return this._autoX},set:function(e){this._autoX=e,this._galleryOverlaysUi.setAutoX({element:this._viewer,autoX:this._autoX})}},{key:"autoY",get:function(){return this._autoY},set:function(e){this._autoY=e,this._galleryOverlaysUi.setAutoY({element:this._viewer,autoY:this._autoY})}},{key:"ImageOverlays",get:function(){var e=this;return["prev","next","current"].map((function(t){return e["_"+t]}))}},{key:"transitionTime",get:function(){return this._transitionTime},set:function(e){this.setTransitionTime(e,!0)}},{key:"centered",get:function(){return this._centered},set:function(e){this._centered=e,this._galleryOverlaysUi.setCentered({element:this._viewer,centered:this._centered})}},{key:"blackScreenMode",get:function(){return this._blackScreenMode},set:function(e){this._blackScreenMode=e,this.setBlackScreenMode(e)}},{key:"slideshowMode",get:function(){return this._slideshowMode},set:function(e){this._slideshowMode=e,this._slideshowMode&&this.prepareNextSlide()}},{key:"preloadAllMode",get:function(){return this._preloadAllMode},set:function(e){this._preloadAllMode=e,this._preloadAllMode&&this.preloadAll({parent:this._mainElement})}},{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this._galleryOverlaysUi.setShown({element:this._viewer,shown:this._shown})}},{key:"slideshowSpeed",get:function(){return this._slideshowSpeed},set:function(e){this.setSlideshowSpeed(e,!1)}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this.setMaxSize(e,!1)}},{key:"relative",set:function(e){this._relative=e,this._galleryOverlaysUi.setRelative({element:this._viewer,relative:this._relative})},get:function(){return this._relative}},{key:"bindables",get:function(){return this._bindables},set:function(e){this._bindables=e}}]),t}(),I=QILVGalleryInit=function(){if(window.QILVGalleryOverlays)window.QILVGalleryOverlays.shown=!0;else{var e=window.QILV_config||window.GM_values||{},t=new g,n=new A({domAccess:t}),i=new S({domAccess:t}),r=new x({config:e}),o=new E({imageOverlayFactory:n,galleryOverlaysUi:i,vk:r,config:e});window.QILVGalleryOverlays=o,o.init()}};e.then((function(){return I()}));
